#!/usr/bin/env node
'use strict';var commander=require('commander'),O=require('fast-glob'),r=require('fs'),u=require('path');function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var O__default=/*#__PURE__*/_interopDefault(O);var r__default=/*#__PURE__*/_interopDefault(r);var u__default=/*#__PURE__*/_interopDefault(u);var p="-de-limit-er-";var d=new commander.Command;d.version("0.1.0").description("CLI utils for i18n").addOption(new commander.Option("-m, --mode [type]","set mode").choices(["single","split"]).default("single")).addOption(new commander.Option("-i, --inline","is inline mode").default(false)).option("-p, --path [dir]","path for root dir").requiredOption("-d, --dir [name] ","output dir");d.parse();var l=d.opts(),f=l?.path?.replace(/\/$/,"")||".",c=`${f}/${l.dir}`.replace(/\/$/,""),a=l.mode,y=l.inline;if(y&&a==="single")throw new Error("inline mode working only for mode split");r__default.default.existsSync(c)||r__default.default.mkdirSync(c);function g(s){return y?Object.keys(s).reduce((n,e)=>{let o=s[e];for(let t of Object.keys(o)){let i=o[t],w=`${String(e)}${p}${String(t)}`;n[w]=i;}return n},{}):s}async function $(){let s=await O__default.default(`${f}/**/*.i18n.json`,{cwd:process.cwd(),absolute:false,onlyFiles:true}),n={};for(let e of s){let o=e.replace(f,"."),t=r__default.default.readFileSync(e).toString("utf-8");n[o]=JSON.parse(t);}if(!s.length){console.log("Files not found. use: *.i18n.json format file");return}for(let e of r__default.default.readdirSync(c))r__default.default.rmSync(`${c}/${e}`);if(a==="split"){let e={};for(let o of Object.keys(n)){let t=Object.keys(n[o]);for(let i of t)e[i]||(e[i]={}),e[i][o]={},e[i][o]=n[o][i];}for(let o of Object.keys(e)){let t=JSON.stringify(g(e[o]),null,2);r__default.default.writeFileSync(u__default.default.resolve(c,`${o}.json`),t,"utf-8");}}if(a==="single"){let e=JSON.stringify(g(n),null,2);r__default.default.writeFileSync(u__default.default.resolve(c,"locales.json"),e,"utf-8");}}$();//# sourceMappingURL=dump.js.map
//# sourceMappingURL=dump.js.map