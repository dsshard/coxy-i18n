#!/usr/bin/env node
'use strict';var O=require('fast-glob'),commander=require('commander'),a=require('path'),f=require('fs');function _interopDefault(e){return e&&e.__esModule?e:{default:e}}var O__default=/*#__PURE__*/_interopDefault(O);var a__default=/*#__PURE__*/_interopDefault(a);var f__default=/*#__PURE__*/_interopDefault(f);var u="-de-limit-er-";var m=new commander.Command;m.version("0.1.0").description("CLI utils for i18n").addOption(new commander.Option("-m, --mode [type]","set mode").choices(["single","split"]).default("single")).addOption(new commander.Option("-i, --inline","is inline mode").default(false)).addOption(new commander.Option("-me, --merge","merge content").default(true)).option("-p, --path [dir]","path for root dir").requiredOption("-d, --dir [name] ","base directory for restore");m.parse();var r=m.opts(),h=r?.path?.replace(/\/$/,"")||".",b=r?.dir?.replace(/\/$/,""),p=r.mode,F=r.merge,y=r.inline;if(y&&p==="single")throw new Error("inline mode working only for mode split");function R(n){return y?Object.keys(n).reduce((e,o)=>{let[t,i]=o.split(u);return e[t]||(e[t]={}),e[t][i]=n[o],e},{}):n}async function j(){let n=a__default.default.resolve(h,b),e={};if(p==="split"){let o=await O__default.default(`${n}/*.json`);if(!o.length)return;for(let t of o){let s=a__default.default.parse(t).base.split(".")[0],c=f__default.default.readFileSync(t).toString(),g=R(JSON.parse(c)),w=Object.keys(g);for(let l of w)e[l]||(e[l]={}),e[l][s]=g[l];}}if(p==="single"){let o=f__default.default.readFileSync(a__default.default.resolve(n,"locales.json")).toString();if(!o.length)return;e=JSON.parse(o);}for(let o of Object.keys(e)){let t=a__default.default.resolve(h,o),i=e[o];if(F){let s=f__default.default.readFileSync(t).toString();if(s.length){let c=JSON.parse(s);i=Object.assign({},c,i);}}f__default.default.writeFileSync(t,JSON.stringify(i,null,2),"utf-8");}}j();//# sourceMappingURL=restore.js.map
//# sourceMappingURL=restore.js.map