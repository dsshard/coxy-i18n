#!/usr/bin/env node
import {Command,Option}from'commander';import O from'fast-glob';import r from'node:fs';import u from'node:path';var p="-de-limit-er-";var d=new Command;d.version("0.1.0").description("CLI utils for i18n").addOption(new Option("-m, --mode [type]","set mode").choices(["single","split"]).default("single")).addOption(new Option("-i, --inline","is inline mode").default(false)).option("-p, --path [dir]","path for root dir").requiredOption("-d, --dir [name] ","output dir");d.parse();var l=d.opts(),f=l?.path?.replace(/\/$/,"")||".",c=`${f}/${l.dir}`.replace(/\/$/,""),a=l.mode,y=l.inline;if(y&&a==="single")throw new Error("inline mode working only for mode split");r.existsSync(c)||r.mkdirSync(c);function g(s){return y?Object.keys(s).reduce((n,e)=>{let o=s[e];for(let t of Object.keys(o)){let i=o[t],w=`${String(e)}${p}${String(t)}`;n[w]=i;}return n},{}):s}async function $(){let s=await O(`${f}/**/*.i18n.json`,{cwd:process.cwd(),absolute:false,onlyFiles:true}),n={};for(let e of s){let o=e.replace(f,"."),t=r.readFileSync(e).toString("utf-8");n[o]=JSON.parse(t);}if(!s.length){console.log("Files not found. use: *.i18n.json format file");return}for(let e of r.readdirSync(c))r.rmSync(`${c}/${e}`);if(a==="split"){let e={};for(let o of Object.keys(n)){let t=Object.keys(n[o]);for(let i of t)e[i]||(e[i]={}),e[i][o]={},e[i][o]=n[o][i];}for(let o of Object.keys(e)){let t=JSON.stringify(g(e[o]),null,2);r.writeFileSync(u.resolve(c,`${o}.json`),t,"utf-8");}}if(a==="single"){let e=JSON.stringify(g(n),null,2);r.writeFileSync(u.resolve(c,"locales.json"),e,"utf-8");}}$();//# sourceMappingURL=dump.mjs.map
//# sourceMappingURL=dump.mjs.map